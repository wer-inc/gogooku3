============================================================
Complete ATFT-GAT-FAN Training Pipeline
Target Sharpe Ratio: 0.849
============================================================
2025-10-28 23:54:09,473 - __main__ - INFO - üöÄ Complete ATFT-GAT-FAN Training Pipeline started
2025-10-28 23:54:09,474 - __main__ - INFO - üéØ Target Sharpe Ratio: 0.849
2025-10-28 23:54:09,474 - __main__ - INFO - üîß Setting up ATFT-GAT-FAN environment...
2025-10-28 23:54:09,476 - __main__ - INFO - ‚úÖ ATFT-GAT-FAN environment setup completed
2025-10-28 23:54:09,476 - __main__ - INFO - üìä Loading and validating ML dataset...
2025-10-28 23:54:09,480 - __main__ - INFO - üìÇ Loading ML dataset from: output/ml_dataset_latest_full.parquet
2025-10-28 23:56:10,487 - __main__ - INFO - ‚úÖ ML dataset loaded: (4643854, 395)
2025-10-28 23:56:10,490 - __main__ - INFO - üîÑ Converting ML dataset to ATFT-GAT-FAN format...
2025-10-28 23:56:10,522 - __main__ - INFO - Using curated feature groups ['core50', 'plus30'] (78 features + 4 masks = 82 columns)
2025-10-28 23:56:10,547 - __main__ - INFO - ‚ôªÔ∏è  Reusing existing converted data at output/atft_data (skip conversion)
2025-10-28 23:56:10,552 - __main__ - INFO - ‚úÖ Conversion completed: Mode = UnifiedFeatureConverter
2025-10-28 23:56:10,553 - __main__ - INFO - üìã Preparing ATFT-GAT-FAN training data...
2025-10-28 23:56:10,553 - __main__ - INFO - ‚úÖ ATFT-GAT-FAN training data prepared: 100 train files
2025-10-28 23:56:10,553 - __main__ - INFO - üèãÔ∏è Executing ATFT-GAT-FAN training with results reproduction...
2025-10-28 23:56:10,554 - __main__ - INFO - [Safe Mode] Setting single-worker DataLoader: batch_size=256, num_workers=0
2025-10-28 23:56:10,638 - __main__ - INFO - Running command: python scripts/train_atft.py data.source.data_dir=output/atft_data train.batch.train_batch_size=256 train.batch.num_workers=0 train.batch.prefetch_factor=null train.batch.persistent_workers=false train.batch.pin_memory=false train.optimizer.lr=0.0002 train.trainer.max_epochs=1 train.trainer.precision=16-mixed train.trainer.check_val_every_n_epoch=1 train.trainer.enable_progress_bar=true model.input_dims.total_features=82 model.input_dims.historical_features=0 model.input_dims.basic_features=82 train.batch.num_workers=0 train.batch.prefetch_factor=null train.batch.persistent_workers=false train.batch.pin_memory=false --config-path ../configs/atft
2025-10-28 23:56:10,638 - __main__ - INFO - [pipeline] Forcing USE_DAY_BATCH=0 for CPU execution
Using optimized data loader
INFO:root:[logger] FileHandler attached: /workspace/gogooku3/logs/ml_training.log
[2025-10-28 23:56:14,425][__main__][INFO] - Starting production training...
/usr/local/lib/python3.12/dist-packages/torch/backends/__init__.py:46: UserWarning: Please use the new API settings to control TF32 behavior, such as torch.backends.cudnn.conv.fp32_precision = 'tf32' or torch.backends.cuda.matmul.fp32_precision = 'ieee'. Old settings, e.g, torch.backends.cuda.matmul.allow_tf32 = True, torch.backends.cudnn.allow_tf32 = True, allowTF32CuDNN() and allowTF32CuBLAS() will be deprecated after Pytorch 2.9. Please see https://pytorch.org/docs/main/notes/cuda.html#tensorfloat-32-tf32-on-ampere-and-later-devices (Triggered internally at /pytorch/aten/src/ATen/Context.cpp:80.)
  self.setter(val)
[2025-10-28 23:56:14,453][__main__][INFO] - üöÄ A100 optimizations enabled: TF32=True, cudnn_benchmark=True
[2025-10-28 23:56:14,477][__main__][INFO] - üéÆ GPU: NVIDIA A100-SXM4-80GB (85.0GB)
[2025-10-28 23:56:14,478][__main__][INFO] - [EnvOverride] train.trainer.precision = bf16-mixed
[2025-10-28 23:56:14,478][__main__][INFO] - [EnvOverride] DEGENERACY_GUARD = True (via environment)
[2025-10-28 23:56:14,478][__main__][INFO] - [EnvOverride] OUTPUT_NOISE_STD = 0.02 (via environment)
[2025-10-28 23:56:14,480][src.utils.config_validator][INFO] - Configuration validation passed
[2025-10-28 23:56:14,482][__main__][INFO] - Random seed: 42, Deterministic: False
[2025-10-28 23:56:14,715][__main__][INFO] - Using device: cuda
[2025-10-28 23:56:14,716][__main__][INFO] - GPU: NVIDIA A100-SXM4-80GB
[2025-10-28 23:56:14,716][__main__][INFO] - GPU Memory: 85.0GB
[2025-10-28 23:56:14,846][__main__][INFO] - Found hidden_size=256 at path: model.hidden_size
[2025-10-28 23:56:14,848][__main__][INFO] - Setting up data module...
[2025-10-28 23:56:14,849][__main__][INFO] - [Hydra-Struct] data.schema detected with keys: ['date_column', 'code_column', 'target_column', 'target_columns', 'feature_columns', 'static_columns', 'regime_columns']
[2025-10-28 23:56:14,850][__main__][INFO] - [Hydra-Struct] data group keys: ['graph_builder', 'name', 'schema', 'use_buffered_loader', 'source', 'memory', 'distributed', 'sampling', 'time_series', 'features', 'feature_cols', 'loader', 'graph', 'use_day_batch_sampler']
[2025-10-28 23:56:14,857][src.gogooku3.training.atft.data_module][INFO] - üìÇ Found 100 train, 100 val, 0 test files
[2025-10-28 23:56:14,858][src.gogooku3.training.atft.data_module][INFO] - ‚úÖ Using explicit target columns from config: ['target_1d', 'target_5d', 'target_10d', 'target_20d']
[2025-10-28 23:56:14,859][src.gogooku3.training.atft.data_module][INFO] - Selected data loader implementation: iterable_v1
[2025-10-28 23:56:14,860][src.gogooku3.training.atft.data_module][INFO] - Fitting OnlineRobustScaler on training data (max_samples=250000, files=100)...
[2025-10-28 23:57:43,849][src.gogooku3.training.atft.data_module][INFO] - ‚úÖ Iterable datasets ready (train_files=100, val_files=100, test_files=0, seq_len=20)
[2025-10-28 23:57:43,851][__main__][INFO] - [data-filter] Global minimum date filter: 2016-01-01
[2025-10-28 23:57:43,851][__main__][INFO] - [data-filter] This ensures sufficient history for computing forward-looking returns
[2025-10-28 23:57:43,851][__main__][INFO] - Creating data loaders...
[2025-10-28 23:57:43,852][src.gogooku3.training.atft.data_module][INFO] - [SAFE MODE] Enforcing single-process DataLoader (num_workers=0) due to FORCE_SINGLE_PROCESS=1
[2025-10-28 23:57:43,853][src.gogooku3.training.atft.data_module][INFO] - [SAFE MODE] Limited PyTorch threads to 1 (prevents 128-thread deadlock)
[2025-10-28 23:57:43,853][src.gogooku3.training.atft.data_module][INFO] - Using iterable DataLoader (shuffle disabled) for training split
[2025-10-28 23:57:43,854][src.gogooku3.training.atft.data_module][INFO] - [SAFE MODE] Enforcing single-process DataLoader (num_workers=0) due to FORCE_SINGLE_PROCESS=1
[2025-10-28 23:57:43,855][src.gogooku3.training.atft.data_module][INFO] - [SAFE MODE] Limited PyTorch threads to 1 (prevents 128-thread deadlock)
[2025-10-28 23:57:43,856][__main__][WARNING] - DayBatch/collate setup skipped: DataLoader with IterableDataset: expected unspecified shuffle option, but got shuffle=True
[2025-10-28 23:57:49,409][__main__][INFO] - [input_dim] detected from data: F=82 (was: 13)
[2025-10-28 23:57:49,411][__main__][INFO] - Train batches: unknown
[2025-10-28 23:57:49,414][__main__][INFO] - Val batches: unknown
[2025-10-28 23:57:49,416][__main__][INFO] - Validating label normalization...
[2025-10-28 23:57:49,470][__main__][INFO] - Target horizon_1: mean=0.000763, std=0.008553
[2025-10-28 23:57:49,470][__main__][INFO] - Target horizon_5: mean=0.004600, std=0.019692
[2025-10-28 23:57:49,471][__main__][INFO] - Target horizon_10: mean=0.011444, std=0.022506
[2025-10-28 23:57:49,472][__main__][INFO] - Target horizon_20: mean=0.022997, std=0.027307
[2025-10-28 23:57:49,619][__main__][INFO] - [debug-first-batch-keys] ['features', 'targets', 'code', 'date']
[2025-10-28 23:57:49,620][__main__][INFO] - [debug-first-batch-type] features: <class 'torch.Tensor'>
[2025-10-28 23:57:49,621][__main__][INFO] - [debug-first-batch-type] targets: <class 'dict'>
[2025-10-28 23:57:49,621][__main__][INFO] - [debug-first-batch-type] code: <class 'list'>
[2025-10-28 23:57:49,622][__main__][INFO] - [debug-first-batch-type] date: <class 'list'>
/workspace/gogooku3/scripts/train_atft.py:6408: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  "timestamp": datetime.utcnow().isoformat() + "Z",
/workspace/gogooku3/scripts/train_atft.py:6431: DeprecationWarning: datetime.datetime.utcnow() is deprecated and scheduled for removal in a future version. Use timezone-aware objects to represent datetimes in UTC: datetime.datetime.now(datetime.UTC).
  / f"train_manifest_{datetime.utcnow().strftime('%Y%m%d_%H%M%S')}.json"
[2025-10-28 23:57:49,693][__main__][INFO] - Initializing model...
[2025-10-28 23:57:49,694][src.atft_gat_fan.models.architectures.atft_gat_fan][INFO] - ‚úÖ Feature dimensions resolved from config: total=82, current=82, historical=0, static=0
[2025-10-28 23:57:49,805][src.atft_gat_fan.models.architectures.atft_gat_fan][INFO] - [GAT-INIT] gat_entropy_weight=0.001, gat_edge_weight=0.01, gat_output_dim=256
[2025-10-28 23:57:49,833][src.atft_gat_fan.models.architectures.atft_gat_fan][INFO] - ‚úÖ [GAT-FIX] Applied 3x weight scaling + residual gate (Œ±=0.5)
[2025-10-28 23:57:49,839][src.atft_gat_fan.models.architectures.atft_gat_fan][INFO] - ATFT-GAT-FAN initialized with 82 dynamic features
[2025-10-28 23:57:49,937][__main__][INFO] - ‚úÖ [GAT-FIX] backbone_projection GATÈÉ®ÂàÜ„ÅÆÈáç„Åø„Çí2.0ÂÄç„Å´„Çπ„Ç±„Éº„É™„É≥„Ç∞
[2025-10-28 23:57:51,202][__main__][INFO] - ATFT-GAT-FAN model parameters: 22,533,021
[2025-10-28 23:57:51,210][__main__][INFO] - [CONFIG-DEBUG] model.gat_entropy_weight=0.001
[2025-10-28 23:57:51,211][__main__][INFO] - [CONFIG-DEBUG] model.gat_edge_weight=0.01
[2025-10-28 23:57:51,212][__main__][INFO] - [CONFIG-DEBUG] model.gat is None: False
[2025-10-28 23:57:51,212][__main__][INFO] - [CONFIG-DEBUG] model.gat_output_dim=256
[2025-10-28 23:57:51,472][runtime_guards][INFO] - [runtime-guards] Installed 2 activation guard(s) on: prediction_head, gat
[2025-10-28 23:57:51,475][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads
[2025-10-28 23:57:51,476][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_1d
[2025-10-28 23:57:51,477][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_1d.0
[2025-10-28 23:57:51,477][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_1d.1
[2025-10-28 23:57:51,478][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_1d.2
[2025-10-28 23:57:51,478][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_1d.3
[2025-10-28 23:57:51,479][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_5d
[2025-10-28 23:57:51,480][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_5d.0
[2025-10-28 23:57:51,480][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_5d.1
[2025-10-28 23:57:51,480][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_5d.2
[2025-10-28 23:57:51,481][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_5d.3
[2025-10-28 23:57:51,482][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d
[2025-10-28 23:57:51,482][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.0
[2025-10-28 23:57:51,483][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.1
[2025-10-28 23:57:51,483][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.2
[2025-10-28 23:57:51,484][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.3
[2025-10-28 23:57:51,485][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.4
[2025-10-28 23:57:51,485][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_10d.5
[2025-10-28 23:57:51,486][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d
[2025-10-28 23:57:51,487][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.0
[2025-10-28 23:57:51,487][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.1
[2025-10-28 23:57:51,488][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.2
[2025-10-28 23:57:51,488][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.3
[2025-10-28 23:57:51,489][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.4
[2025-10-28 23:57:51,489][__main__][INFO] - Added initial noise (std=0.05) to prediction_head.horizon_heads.horizon_20d.5
[2025-10-28 23:57:51,490][__main__][INFO] - [AMP] GradScaler initialized: enabled=False, amp_dtype=torch.bfloat16
[2025-10-28 23:57:51,496][__main__][INFO] - [OPT-AUDIT] ‚úì Optimizer covers 22533021/22533021 trainable params
[2025-10-28 23:57:51,496][__main__][INFO] - Batch size: 256
[2025-10-28 23:57:51,497][__main__][INFO] - Gradient accumulation steps: 2
[2025-10-28 23:57:51,497][__main__][INFO] - Effective batch size: 512
[2025-10-28 23:57:51,498][__main__][INFO] - Starting training loop (main)...
[2025-10-28 23:57:51,498][__main__][INFO] - Time budget: 2.0 hours
[2025-10-28 23:57:51,498][__main__][INFO] - Eval every: 100 steps
[2025-10-28 23:57:51,499][__main__][INFO] - Heartbeat interval: 30s
[2025-10-28 23:57:51,521][__main__][INFO] - [GraphBuilder] return_cols extended to ['return_1d', 'feat_ret_1d', 'target_1d']
[2025-10-28 23:57:51,522][src.graph.graph_builder][INFO] - GraphBuilder initialized with max_nodes=100, returns_channel_index=auto
[2025-10-28 23:57:51,523][src.graph.graph_builder][INFO] - FinancialGraphBuilder enabled (source_glob=output/atft_data/train/*.parquet, window=60)
[2025-10-28 23:57:51,523][__main__][INFO] - [GraphBuilder] initialized from output/atft_data/train/*.parquet (lookback=60, k=15)
[2025-10-28 23:57:51,757][__main__][INFO] - SWA enabled: averaging parameters after 0.67 of epochs (lr_factor=0.50)
[2025-10-28 23:57:51,760][__main__][INFO] - Running first-batch probe...
[2025-10-28 23:57:51,827][__main__][INFO] - Batch 0: features shape=torch.Size([64, 20, 82]), dtype=torch.float32, mean=-0.0000, std=0.1104
[2025-10-28 23:57:52,041][__main__][INFO] -   Output features: shape=(64, 20), dtype=torch.float32
[2025-10-28 23:57:52,087][__main__][INFO] - Batch 1: features shape=torch.Size([64, 20, 82]), dtype=torch.float32, mean=0.0000, std=0.0000
[2025-10-28 23:57:52,141][__main__][INFO] -   Output features: shape=(64, 20), dtype=torch.float32
[2025-10-28 23:57:52,192][__main__][INFO] - Batch 2: features shape=torch.Size([64, 20, 82]), dtype=torch.float32, mean=-0.0000, std=0.1104
[2025-10-28 23:57:52,243][__main__][INFO] -   Output features: shape=(64, 20), dtype=torch.float32
[2025-10-28 23:57:52,287][__main__][INFO] - ‚úì First-batch probe passed
[2025-10-28 23:57:52,288][__main__][INFO] - First batch probe passed
[2025-10-28 23:57:52,442][__main__][INFO] - [SamplerCheck] first_batch_size=256 (configured=256)
[2025-10-28 23:57:52,443][__main__][INFO] - 
==================================================
[2025-10-28 23:57:52,443][__main__][INFO] - [main] Epoch 1/1
[2025-10-28 23:57:52,444][__main__][INFO] - Learning rate: 0.000100
[2025-10-28 23:57:52,445][__main__][INFO] - [sched] epoch=1 knn_k=20 edge_dropout=0.05

Epoch 1: 0it [00:00, ?it/s][2025-10-28 23:57:53,997][__main__][INFO] - [EDGE-TS] asof=2024-01-25 staleness_days=1
[2025-10-28 23:57:55,322][src.graph.graph_builder][INFO] - GraphBuilder initialized with max_nodes=256, returns_channel_index=auto
[2025-10-28 23:57:55,325][src.graph.graph_builder][INFO] - GraphBuilder running without source_glob; using local correlation fallback.
[2025-10-28 23:57:55,326][src.graph.graph_builder][WARNING] - GraphBuilder fallback: returns_channel_index not provided; defaulting to channel 0. Set GBConfig.returns_channel_index or GRAPH_RET_IDX to control this selection.
[2025-10-28 23:57:55,943][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:57:56,027][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:57:56,285][runtime_guards][WARNING] - [runtime-guards] High activation detected in 'gat' (|x|max=2.550e+02)
[2025-10-28 23:57:56,339][__main__][INFO] - [DEBUG-EDGE] step=0, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:57:56,340][__main__][INFO] - [DEBUG-KEYS] Raw model output type: <class 'dict'>
[2025-10-28 23:57:56,341][__main__][INFO] - [DEBUG-KEYS] Raw output top-level keys: ['predictions', 'features', 'output_type']
[2025-10-28 23:57:56,342][__main__][INFO] - [DEBUG-KEYS] predictions type: <class 'dict'>
[2025-10-28 23:57:56,342][__main__][INFO] - [DEBUG-KEYS] predictions keys: ['horizon_1d', 'horizon_5d', 'horizon_10d', 'horizon_20d']
[2025-10-28 23:57:56,343][__main__][INFO] - [DEBUG-KEYS] Target type: <class 'dict'>
[2025-10-28 23:57:56,344][__main__][INFO] - [DEBUG-KEYS] Target keys: ['horizon_1', 'horizon_5', 'horizon_10', 'horizon_20']
[2025-10-28 23:57:56,543][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 0it [00:04, ?it/s, loss=0.3374]
Epoch 1: 1it [00:04,  4.21s/it, loss=0.3374][2025-10-28 23:57:57,344][__main__][INFO] - [EDGE-TS] asof=2024-07-18 staleness_days=1
[2025-10-28 23:57:57,883][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:57:57,972][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:57:58,110][__main__][INFO] - [DEBUG-EDGE] step=0, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:57:58,111][__main__][INFO] - [DEBUG-KEYS] Raw model output type: <class 'dict'>
[2025-10-28 23:57:58,112][__main__][INFO] - [DEBUG-KEYS] Raw output top-level keys: ['predictions', 'features', 'output_type']
[2025-10-28 23:57:58,112][__main__][INFO] - [DEBUG-KEYS] predictions type: <class 'dict'>
[2025-10-28 23:57:58,113][__main__][INFO] - [DEBUG-KEYS] predictions keys: ['horizon_1d', 'horizon_5d', 'horizon_10d', 'horizon_20d']
[2025-10-28 23:57:58,113][__main__][INFO] - [DEBUG-KEYS] Target type: <class 'dict'>
[2025-10-28 23:57:58,114][__main__][INFO] - [DEBUG-KEYS] Target keys: ['horizon_1', 'horizon_5', 'horizon_10', 'horizon_20']
[2025-10-28 23:57:58,145][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:57:58,255][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=0) -- tolerated in warmup

Epoch 1: 2it [00:05,  2.74s/it, loss=0.3374][2025-10-28 23:57:59,169][__main__][INFO] - [EDGE-TS] asof=2024-07-10 staleness_days=1
[2025-10-28 23:57:59,637][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:57:59,725][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:57:59,799][__main__][INFO] - [DEBUG-EDGE] step=1, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:57:59,837][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 3it [00:07,  2.20s/it, loss=0.3374][2025-10-28 23:58:00,790][__main__][INFO] - [EDGE-TS] asof=2024-07-02 staleness_days=1
[2025-10-28 23:58:01,331][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:01,421][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:01,512][__main__][INFO] - [DEBUG-EDGE] step=1, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:01,540][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:01,671][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=1) -- tolerated in warmup

Epoch 1: 4it [00:09,  2.03s/it, loss=0.3374][2025-10-28 23:58:02,348][__main__][INFO] - [EDGE-TS] asof=2024-06-24 staleness_days=1
[2025-10-28 23:58:02,866][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:02,953][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:03,033][__main__][INFO] - [DEBUG-EDGE] step=2, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:03,061][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 5it [00:10,  1.83s/it, loss=0.3374][2025-10-28 23:58:03,916][__main__][INFO] - [EDGE-TS] asof=2024-06-16 staleness_days=1
[2025-10-28 23:58:04,393][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:04,484][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:04,570][__main__][INFO] - [DEBUG-EDGE] step=2, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:04,598][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:04,712][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=2) -- tolerated in warmup

Epoch 1: 6it [00:12,  1.74s/it, loss=0.3374][2025-10-28 23:58:05,452][__main__][INFO] - [EDGE-TS] asof=2024-06-06 staleness_days=1
[2025-10-28 23:58:05,997][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:06,084][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:06,168][__main__][INFO] - [DEBUG-EDGE] step=3, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:06,196][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 7it [00:13,  1.68s/it, loss=0.3374][2025-10-28 23:58:06,976][__main__][INFO] - [EDGE-TS] asof=2024-05-29 staleness_days=1
[2025-10-28 23:58:07,538][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:07,623][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:07,722][__main__][INFO] - [DEBUG-EDGE] step=3, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:07,799][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:07,926][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=3) -- tolerated in warmup

Epoch 1: 8it [00:15,  1.67s/it, loss=0.3374][2025-10-28 23:58:08,618][__main__][INFO] - [EDGE-TS] asof=2024-05-21 staleness_days=1
[2025-10-28 23:58:09,130][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:09,223][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:09,320][__main__][INFO] - [DEBUG-EDGE] step=4, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:09,348][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 9it [00:17,  1.62s/it, loss=0.3374][2025-10-28 23:58:10,030][__main__][INFO] - [EDGE-TS] asof=2024-05-13 staleness_days=1
[2025-10-28 23:58:10,549][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:10,637][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:10,711][__main__][INFO] - [DEBUG-EDGE] step=4, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:10,756][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:10,881][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=4) -- tolerated in warmup

Epoch 1: 10it [00:18,  1.57s/it, loss=0.3374][2025-10-28 23:58:11,618][__main__][INFO] - [EDGE-TS] asof=2024-05-05 staleness_days=1
[2025-10-28 23:58:12,149][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:12,236][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:12,310][__main__][INFO] - [DEBUG-EDGE] step=5, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:12,350][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 10it [00:20,  1.57s/it, loss=0.3539]
Epoch 1: 11it [00:20,  1.56s/it, loss=0.3539][2025-10-28 23:58:13,033][__main__][INFO] - [EDGE-TS] asof=2024-04-25 staleness_days=1
[2025-10-28 23:58:13,556][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:13,642][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:13,738][__main__][INFO] - [DEBUG-EDGE] step=5, edge_index=shape=torch.Size([2, 2786]), edge_attr=shape=torch.Size([2786, 3])
[2025-10-28 23:58:13,817][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:13,931][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=5) -- tolerated in warmup

Epoch 1: 12it [00:21,  1.54s/it, loss=0.3539][2025-10-28 23:58:14,524][__main__][INFO] - [EDGE-TS] asof=2024-04-17 staleness_days=1
[2025-10-28 23:58:15,045][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:15,134][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:15,298][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 13it [00:22,  1.52s/it, loss=0.3539][2025-10-28 23:58:16,029][__main__][INFO] - [EDGE-TS] asof=2024-04-09 staleness_days=1
[2025-10-28 23:58:16,567][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:16,654][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:16,770][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:16,883][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=6) -- tolerated in warmup

Epoch 1: 14it [00:24,  1.51s/it, loss=0.3539][2025-10-28 23:58:17,559][__main__][INFO] - [EDGE-TS] asof=2024-04-01 staleness_days=1
[2025-10-28 23:58:18,084][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:18,173][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:18,277][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 15it [00:25,  1.50s/it, loss=0.3539][2025-10-28 23:58:19,045][__main__][INFO] - [EDGE-TS] asof=2024-03-24 staleness_days=1
[2025-10-28 23:58:19,529][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:19,621][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:19,726][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:19,885][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=7) -- tolerated in warmup

Epoch 1: 16it [00:27,  1.51s/it, loss=0.3539][2025-10-28 23:58:20,489][__main__][INFO] - [EDGE-TS] asof=2024-03-14 staleness_days=1
[2025-10-28 23:58:21,024][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:21,115][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:21,223][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 17it [00:28,  1.48s/it, loss=0.3539][2025-10-28 23:58:21,946][__main__][INFO] - [EDGE-TS] asof=2024-03-06 staleness_days=1
[2025-10-28 23:58:22,450][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:22,540][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:22,639][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:22,805][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=8) -- tolerated in warmup

Epoch 1: 18it [00:30,  1.49s/it, loss=0.3539][2025-10-28 23:58:23,479][__main__][INFO] - [EDGE-TS] asof=2024-02-27 staleness_days=1
[2025-10-28 23:58:23,949][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:24,039][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:24,150][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 19it [00:31,  1.47s/it, loss=0.3539][2025-10-28 23:58:24,960][__main__][INFO] - [EDGE-TS] asof=2024-02-19 staleness_days=1
[2025-10-28 23:58:25,479][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:25,574][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:25,698][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:25,816][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=9) -- tolerated in warmup

Epoch 1: 20it [00:33,  1.50s/it, loss=0.3539][2025-10-28 23:58:26,656][__main__][INFO] - [EDGE-TS] asof=2024-02-11 staleness_days=1
[2025-10-28 23:58:27,141][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:27,232][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:27,348][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 20it [00:35,  1.50s/it, loss=0.3522]
Epoch 1: 21it [00:35,  1.54s/it, loss=0.3522][2025-10-28 23:58:28,116][__main__][INFO] - [EDGE-TS] asof=2024-02-01 staleness_days=1
[2025-10-28 23:58:28,643][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:28,733][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:28,882][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:28,994][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=10) -- tolerated in warmup

Epoch 1: 22it [00:36,  1.54s/it, loss=0.3522][2025-10-28 23:58:29,667][__main__][INFO] - [EDGE-TS] asof=2024-07-25 staleness_days=1
[2025-10-28 23:58:30,186][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:30,276][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:30,378][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 23it [00:38,  1.52s/it, loss=0.3522][2025-10-28 23:58:31,163][__main__][INFO] - [EDGE-TS] asof=2024-07-17 staleness_days=1
[2025-10-28 23:58:31,635][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:31,722][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:31,825][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:31,989][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=11) -- tolerated in warmup

Epoch 1: 24it [00:39,  1.52s/it, loss=0.3522][2025-10-28 23:58:32,775][__main__][INFO] - [EDGE-TS] asof=2024-07-09 staleness_days=1
[2025-10-28 23:58:33,324][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:33,420][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:33,539][__main__][INFO] - Data staleness stats (last 100 batches): avg=0.00 days, max=0.00 days
[2025-10-28 23:58:33,561][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 25it [00:41,  1.56s/it, loss=0.3522][2025-10-28 23:58:34,468][__main__][INFO] - [EDGE-TS] asof=2024-07-01 staleness_days=1
[2025-10-28 23:58:35,013][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:35,104][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:35,216][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:35,356][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=12) -- tolerated in warmup

Epoch 1: 26it [00:42,  1.61s/it, loss=0.3522][2025-10-28 23:58:36,026][__main__][INFO] - [EDGE-TS] asof=2024-06-23 staleness_days=1
[2025-10-28 23:58:36,554][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:36,648][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:36,774][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 27it [00:44,  1.57s/it, loss=0.3522][2025-10-28 23:58:37,666][__main__][INFO] - [EDGE-TS] asof=2024-06-13 staleness_days=1
[2025-10-28 23:58:38,200][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:38,303][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:38,410][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:38,529][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=13) -- tolerated in warmup

Epoch 1: 28it [00:46,  1.61s/it, loss=0.3522][2025-10-28 23:58:39,189][__main__][INFO] - [EDGE-TS] asof=2024-06-05 staleness_days=1
[2025-10-28 23:58:39,720][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:39,809][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:39,908][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 29it [00:47,  1.56s/it, loss=0.3522][2025-10-28 23:58:40,744][__main__][INFO] - [EDGE-TS] asof=2024-05-28 staleness_days=1
[2025-10-28 23:58:41,297][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:41,387][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:41,580][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:41,696][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=14) -- tolerated in warmup

Epoch 1: 30it [00:49,  1.60s/it, loss=0.3522][2025-10-28 23:58:42,337][__main__][INFO] - [EDGE-TS] asof=2024-05-20 staleness_days=1
[2025-10-28 23:58:42,870][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:42,961][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:43,075][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 30it [00:50,  1.60s/it, loss=0.3531]
Epoch 1: 31it [00:50,  1.56s/it, loss=0.3531][2025-10-28 23:58:44,045][__main__][INFO] - [EDGE-TS] asof=2024-05-12 staleness_days=1
[2025-10-28 23:58:44,595][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:44,690][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:44,813][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:44,947][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=15) -- tolerated in warmup

Epoch 1: 32it [00:52,  1.63s/it, loss=0.3531][2025-10-28 23:58:45,765][__main__][INFO] - [EDGE-TS] asof=2024-05-02 staleness_days=1
[2025-10-28 23:58:46,299][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:46,401][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:46,521][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 33it [00:54,  1.64s/it, loss=0.3531][2025-10-28 23:58:47,484][__main__][INFO] - [EDGE-TS] asof=2024-04-24 staleness_days=1
[2025-10-28 23:58:48,019][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:48,113][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:48,212][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:48,344][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=16) -- tolerated in warmup

Epoch 1: 34it [00:55,  1.67s/it, loss=0.3531][2025-10-28 23:58:49,164][__main__][INFO] - [EDGE-TS] asof=2024-04-16 staleness_days=1
[2025-10-28 23:58:49,703][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:49,795][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:49,900][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 35it [00:57,  1.66s/it, loss=0.3531][2025-10-28 23:58:50,661][__main__][INFO] - [EDGE-TS] asof=2024-04-08 staleness_days=1
[2025-10-28 23:58:51,200][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:51,303][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:51,407][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:51,519][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=17) -- tolerated in warmup

Epoch 1: 36it [00:59,  1.62s/it, loss=0.3531][2025-10-28 23:58:52,234][__main__][INFO] - [EDGE-TS] asof=2024-03-31 staleness_days=1
[2025-10-28 23:58:52,790][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:52,886][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:52,989][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 37it [01:00,  1.60s/it, loss=0.3531][2025-10-28 23:58:53,758][__main__][INFO] - [EDGE-TS] asof=2024-03-21 staleness_days=1
[2025-10-28 23:58:54,289][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:54,380][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:54,514][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:54,655][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=18) -- tolerated in warmup

Epoch 1: 38it [01:02,  1.60s/it, loss=0.3531][2025-10-28 23:58:55,414][__main__][INFO] - [EDGE-TS] asof=2024-03-13 staleness_days=1
[2025-10-28 23:58:55,960][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:56,048][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:56,225][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 39it [01:03,  1.61s/it, loss=0.3531][2025-10-28 23:58:57,089][__main__][INFO] - [EDGE-TS] asof=2024-03-05 staleness_days=1
[2025-10-28 23:58:57,562][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:57,653][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:57,755][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:58:57,876][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=19) -- tolerated in warmup

Epoch 1: 40it [01:05,  1.60s/it, loss=0.3531][2025-10-28 23:58:58,665][__main__][INFO] - [EDGE-TS] asof=2024-02-26 staleness_days=1
[2025-10-28 23:58:59,124][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:58:59,216][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:58:59,333][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 40it [01:06,  1.60s/it, loss=0.3508]
Epoch 1: 41it [01:06,  1.58s/it, loss=0.3508][2025-10-28 23:59:00,117][__main__][INFO] - [EDGE-TS] asof=2024-02-18 staleness_days=1
[2025-10-28 23:59:00,663][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:00,748][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:00,911][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:01,026][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=20) -- tolerated in warmup

Epoch 1: 42it [01:08,  1.59s/it, loss=0.3508][2025-10-28 23:59:01,740][__main__][INFO] - [EDGE-TS] asof=2024-02-08 staleness_days=1
[2025-10-28 23:59:02,295][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:02,385][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:02,551][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 43it [01:10,  1.60s/it, loss=0.3508][2025-10-28 23:59:03,298][__main__][INFO] - [EDGE-TS] asof=2024-01-31 staleness_days=1
[2025-10-28 23:59:03,845][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:03,934][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:04,057][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:04,168][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=21) -- tolerated in warmup

Epoch 1: 44it [01:11,  1.58s/it, loss=0.3508][2025-10-28 23:59:04,836][__main__][INFO] - [EDGE-TS] asof=2024-07-24 staleness_days=1
[2025-10-28 23:59:05,363][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:05,456][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:05,578][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 45it [01:13,  1.55s/it, loss=0.3508][2025-10-28 23:59:06,465][__main__][INFO] - [EDGE-TS] asof=2024-07-16 staleness_days=1
[2025-10-28 23:59:07,008][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:07,097][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:07,256][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:07,367][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=22) -- tolerated in warmup

Epoch 1: 46it [01:14,  1.60s/it, loss=0.3508][2025-10-28 23:59:08,030][__main__][INFO] - [EDGE-TS] asof=2024-07-08 staleness_days=1
[2025-10-28 23:59:08,580][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:08,673][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:08,784][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 47it [01:16,  1.57s/it, loss=0.3508][2025-10-28 23:59:09,691][__main__][INFO] - [EDGE-TS] asof=2024-06-30 staleness_days=1
[2025-10-28 23:59:10,253][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:10,346][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:10,464][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:10,616][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=23) -- tolerated in warmup

Epoch 1: 48it [01:18,  1.62s/it, loss=0.3508][2025-10-28 23:59:11,274][__main__][INFO] - [EDGE-TS] asof=2024-06-20 staleness_days=1
[2025-10-28 23:59:11,766][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:11,853][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:11,956][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 49it [01:19,  1.56s/it, loss=0.3508][2025-10-28 23:59:12,766][__main__][INFO] - [EDGE-TS] asof=2024-06-12 staleness_days=1
[2025-10-28 23:59:13,254][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:13,346][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:13,459][__main__][INFO] - Data staleness stats (last 100 batches): avg=0.00 days, max=0.00 days
[2025-10-28 23:59:13,481][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:13,592][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=24) -- tolerated in warmup

Epoch 1: 50it [01:21,  1.56s/it, loss=0.3508][2025-10-28 23:59:14,359][__main__][INFO] - [EDGE-TS] asof=2024-06-04 staleness_days=1
[2025-10-28 23:59:14,890][src.graph.graph_builder][INFO] - Built correlation graph: nodes=256, edges=2786, avg_deg=10.88, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:14,983][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=2786
[2025-10-28 23:59:15,093][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00

Epoch 1: 50it [01:22,  1.56s/it, loss=0.3513]
Epoch 1: 51it [01:22,  1.57s/it, loss=0.3513][2025-10-28 23:59:15,841][__main__][INFO] - [EDGE-TS] asof=2024-05-27 staleness_days=1
[2025-10-28 23:59:15,864][src.graph.graph_builder][INFO] - GraphBuilder initialized with max_nodes=44, returns_channel_index=auto
[2025-10-28 23:59:15,865][src.graph.graph_builder][INFO] - GraphBuilder running without source_glob; using local correlation fallback.
[2025-10-28 23:59:15,865][src.graph.graph_builder][WARNING] - GraphBuilder fallback: returns_channel_index not provided; defaulting to channel 0. Set GBConfig.returns_channel_index or GRAPH_RET_IDX to control this selection.
[2025-10-28 23:59:15,968][src.graph.graph_builder][INFO] - Built correlation graph: nodes=44, edges=454, avg_deg=10.32, min_deg=6, thr=0.25, k=20, min_k=5, self_loops=True
[2025-10-28 23:59:15,986][__main__][INFO] - [edges-fallback] built correlation edges from batch: E=454
[2025-10-28 23:59:16,163][src.atft_gat_fan.models.architectures.atft_gat_fan][WARNING] - [GAT-GRAD] Low gradient detected: 0.00e+00
[2025-10-28 23:59:16,318][__main__][WARNING] - [GUARD] GAT grad too small: 0.00e+00 (step=25) -- tolerated in warmup

Epoch 1: 52it [01:23,  1.44s/it, loss=0.3513]
Epoch 1: 52it [01:23,  1.61s/it, loss=0.3513]
[2025-10-28 23:59:16,345][__main__][INFO] - train/total_loss: 0.350750
[2025-10-28 23:59:16,346][__main__][INFO] - Current horizon weights: {1: 0.503259065632814, 5: 0.22506429620960006, 10: 0.15914449005278597, 20: 0.11253214810480003}
[2025-10-28 23:59:16,347][__main__][INFO] - [sanity] grad_norm(gat)=0.000000
[2025-10-28 23:59:16,348][__main__][INFO] - GPU Memory: Used=0.39GB, Cached=5.04GB

Validation: 0it [00:00, ?it/s][2025-10-28 23:59:23,864][src.graph.graph_builder][INFO] - GraphBuilder initialized with max_nodes=4600, returns_channel_index=auto
[2025-10-28 23:59:23,865][src.graph.graph_builder][INFO] - GraphBuilder running without source_glob; using local correlation fallback.
[2025-10-28 23:59:23,866][src.graph.graph_builder][WARNING] - GraphBuilder fallback: returns_channel_index not provided; defaulting to channel 0. Set GBConfig.returns_channel_index or GRAPH_RET_IDX to control this selection.
[2025-10-28 23:59:32,795][src.graph.graph_builder][INFO] - Built correlation graph: nodes=4600, edges=50570, avg_deg=10.99, min_deg=6, thr=0.5, k=20, min_k=5, self_loops=True

Validation: 1it [00:18, 18.46s/it]
Validation: 1it [00:18, 18.46s/it]
[2025-10-28 23:59:34,815][__main__][INFO] - [main] Validation loss: nan
[2025-10-28 23:59:34,816][__main__][INFO] - [EDGE-TS] No staleness data available for validation
[2025-10-28 23:59:34,816][__main__][INFO] - val/loss: nan
[2025-10-28 23:59:34,817][__main__][INFO] - val/epoch: 1
[2025-10-28 23:59:34,817][__main__][INFO] - val/step: 26
[2025-10-28 23:59:34,818][__main__][INFO] -   horizon_1: nan
[2025-10-28 23:59:34,818][__main__][INFO] -   horizon_5: nan
[2025-10-28 23:59:34,819][__main__][INFO] -   horizon_10: nan
[2025-10-28 23:59:34,819][__main__][INFO] -   horizon_20: nan
[2025-10-28 23:59:38,788][__main__][WARNING] - [nan-guard] reshape[horizon_1]: non-finite=100
[2025-10-28 23:59:38,789][__main__][WARNING] - [nan-guard] reshape[horizon_10]: non-finite=1000
[2025-10-28 23:59:38,790][__main__][WARNING] - [nan-guard] reshape[horizon_20]: non-finite=2000
[2025-10-28 23:59:38,791][__main__][WARNING] - [nan-guard] reshape[horizon_5]: non-finite=500
[2025-10-28 23:59:39,261][__main__][INFO] - Validation Metrics Summary:
[2025-10-28 23:59:39,262][__main__][INFO] -   Average RMSE: nan
[2025-10-28 23:59:39,262][__main__][INFO] -   Average R¬≤: nan
[2025-10-28 23:59:39,263][__main__][INFO] -   Average Sharpe Ratio: nan
[2025-10-28 23:59:39,264][__main__][INFO] - Sharpe: nan
[2025-10-28 23:59:39,614][__main__][INFO] - [SWA] Updating BN statistics and evaluating...

Validation: 0it [00:00, ?it/s][2025-10-28 23:59:43,502][__main__][WARNING] - [nan-guard] targets[val][horizon_1]: non-finite=100
[2025-10-28 23:59:43,512][__main__][WARNING] - [nan-guard] targets[val][horizon_10]: non-finite=1000
[2025-10-28 23:59:43,513][__main__][WARNING] - [nan-guard] targets[val][horizon_20]: non-finite=2000
[2025-10-28 23:59:43,514][__main__][WARNING] - [nan-guard] targets[val][horizon_5]: non-finite=500

Validation: 1it [00:04,  4.38s/it]
Validation: 1it [00:04,  4.38s/it]
[2025-10-28 23:59:43,996][__main__][WARNING] - Low prediction variance for horizon 1: scale_ratio=0.0000, yhat_std=0.000000
[2025-10-28 23:59:44,058][root][INFO] - Val metrics (z) h=1: MAE=0.0093 RMSE=0.0116 R2=0.0000 IC=0.0061 NAIVE_RMSE=0.0098 SCALE(yhat/y)=0.00 CAL=+0.000+1.000*yhat
[2025-10-28 23:59:44,059][__main__][WARNING] - Low prediction variance for horizon 5: scale_ratio=0.0000, yhat_std=0.000000
[2025-10-28 23:59:44,060][root][INFO] - Val metrics (z) h=5: MAE=0.0210 RMSE=0.0261 R2=0.0000 IC=0.0215 NAIVE_RMSE=0.0208 SCALE(yhat/y)=0.00 CAL=+0.000+1.000*yhat
[2025-10-28 23:59:44,061][__main__][WARNING] - Low prediction variance for horizon 10: scale_ratio=0.0000, yhat_std=0.000000
[2025-10-28 23:59:44,062][root][INFO] - Val metrics (z) h=10: MAE=0.0210 RMSE=0.0284 R2=0.0000 IC=0.0213 NAIVE_RMSE=0.0276 SCALE(yhat/y)=0.00 CAL=+0.000+1.000*yhat
[2025-10-28 23:59:44,063][__main__][WARNING] - Low prediction variance for horizon 20: scale_ratio=0.0000, yhat_std=0.000000
[2025-10-28 23:59:44,064][root][INFO] - Val metrics (z) h=20: MAE=0.0203 RMSE=0.0340 R2=0.0000 IC=-0.0131 NAIVE_RMSE=0.0340 SCALE(yhat/y)=0.00 CAL=+0.000+1.000*yhat
[2025-10-28 23:59:44,087][__main__][INFO] - [SWA] Validation loss: 0.3504
[2025-10-28 23:59:44,530][__main__][INFO] - [SWA] Saved SWA checkpoint: models/checkpoints/swa_main.pt
[2025-10-28 23:59:44,964][__main__][INFO] - [SWA] SWA model is new BEST; checkpoint updated: models/checkpoints/best_main.pt
[2025-10-28 23:59:44,965][__main__][INFO] - [EXPORT] Exporting validation predictions to file ...
[2025-10-28 23:59:46,793][__main__][WARNING] - [EXPORT] Loading checkpoint for export failed: Weights only load failed. This file can still be loaded, to do so you have two options, [1mdo those steps only if you trust the source of the checkpoint[0m. 
	(1) In PyTorch 2.6, we changed the default value of the `weights_only` argument in `torch.load` from `False` to `True`. Re-running `torch.load` with `weights_only` set to `False` will likely succeed, but it can result in arbitrary code execution. Do it only if you got the file from a trusted source.
	(2) Alternatively, to load with `weights_only=True` please check the recommended steps in the following error message.
	WeightsUnpickler error: Unsupported global: GLOBAL torch.torch_version.TorchVersion was not an allowed global by default. Please use `torch.serialization.add_safe_globals([torch.torch_version.TorchVersion])` or the `torch.serialization.safe_globals([torch.torch_version.TorchVersion])` context manager to allowlist this global if you trust this class/function.

Check the documentation of torch.load to learn more about types accepted by default with weights_only https://pytorch.org/docs/stable/generated/torch.load.html.
[2025-10-28 23:59:50,142][__main__][WARNING] - [EXPORT] Export predictions failed: ATFT_GAT_FAN.forward() takes 2 positional arguments but 5 were given
[2025-10-28 23:59:50,149][__main__][INFO] - 
=== Training Complete ===
[2025-10-28 23:59:50,150][__main__][INFO] - Best validation loss: 0.3504
[2025-10-28 23:59:51,230][__main__][INFO] - Final model saved to models/checkpoints/atft_gat_fan_final.pt
[W1028 23:59:51.119233171 AllocatorConfig.cpp:28] Warning: PYTORCH_CUDA_ALLOC_CONF is deprecated, use PYTORCH_ALLOC_CONF instead (function operator())
2025-10-28 23:59:52,433 - __main__ - INFO - ‚úÖ ATFT-GAT-FAN training completed successfully
2025-10-28 23:59:52,434 - __main__ - INFO - üîç Validating training results...
2025-10-28 23:59:56,126 - __main__ - INFO - ‚úÖ Validation completed: 68010413 parameters
2025-10-28 23:59:56,130 - __main__ - WARNING - Predictions file not found: runs/last/predictions_val.parquet
2025-10-28 23:59:56,174 - __main__ - INFO - üíæ Complete training result saved: output/results/complete_training_result_20251028_235956.json
2025-10-28 23:59:56,175 - __main__ - INFO - ‚úÖ Complete ATFT-GAT-FAN Training Pipeline completed successfully in 346.66s
2025-10-28 23:59:56,175 - __main__ - INFO - üéØ Achieved Sharpe Ratio: 0.08177260619898637
üéâ Complete training pipeline succeeded!
üìä Results: 0.08177260619898637
