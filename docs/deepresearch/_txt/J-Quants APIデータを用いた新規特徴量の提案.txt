J-Quants APIデータを用いた新規特徴量の提案
予測ホライズンと評価指標の設定
本プロジェクトではマルチホライズン予測を採用し、例として 1日後、5日後、10日後、20日後 のリターン
（ target_1d ～ target_20d ）を予測対象とします。これら短期～中期ホライズンを設定することで、デイ
トレード的な超短期から1か月程度のスイングまで幅広く株価変動を捉えます。また評価指標には、主に以下
を用いることを提案します。


   • RankIC（Rank Information Coefficient）：予測スコアと実現リターンの順位相関を測る指標です
      1 。スピアマン順位相関に相当し、外れ値に頑健であるためファクターの予測力を評価するのに適

    しています   1   。特に5日リターンに対するRankIC（例：RankIC_5d）を重視し、モデルが1週間程度
     先の株価の相対的な強弱を捉えられているか確認します。
   • シャープレシオ（Sharpe比）：予測に基づくポートフォリオのリスク調整後リターンを評価します。
     超過リターンをリスク（リターンの標準偏差）で割った指標で、投資判断の質を測る標準的な尺度で
     す 2 。例えばモデル予測に沿ったポートフォリオ運用のシャープレシオを算出し、戦略がどれだけ
    効率的にリターンを上げているか確認します。シャープレシオは高いほどリスク当たりリターンが良
    いことを示し、負の場合は無リスク資産を下回る効率の悪さを意味します 2 。

加えて情報係数（IC）やICの時系列安定性（IC_IR）、勝率、最大ドローダウンなども併用し、ファクターの
一貫性と戦略リスクを総合的に評価します。例えばRankICの平均と標準偏差からIC_IRを算出し、安定した
予測力（IC_IRが高いほど安定）かどうか確認します。またシャープレシオと勝率から、モデル予測に基づく
ロング・ショート戦略の実現可能性（取引コスト後にも有効か）を検証します。


以上のように5日先RankICおよびシャープレシオを主指標に、マルチホライズンでモデル性能を評価しつ
つ、新規特徴量の有効性を判断します。


新規特徴量設計の基本方針
提案する特徴量は、J-Quants APIで取得可能な各種データ系列やイベント情報を組み合わせ、既存特徴量を
補完・拡張してモデル性能の向上を狙うものです。特徴量設計にあたっては以下の基本方針を取ります。


   • リーク防止：各特徴量は将来情報を含まないよう算出時点に注意します。過去データの一定ウィンド
     ウから計算し、当日終了時点までに利用可能な情報のみを用います（例：ファンダメンタル決算情報
     は発表翌日以降に反映、週次データは公表翌営業日以降に反映など）。データ分割→正規化学習→変
     換のパイプライン順序を守り、バリデーション期間に訓練期間の統計量のみを用いることでリークを
     防ぎます。
   • 正規化戦略：クロスセクショナルな正規化を基本とし、各営業日で全銘柄の特徴量を平均との差0、
     標準偏差1にスケーリングします（学習データで算出した基準を適用） 3 。こうすることで異なるス
     ケールの特徴量を比較可能にし、また時系列的な分布変化の影響を抑えます。また一部の特徴量には
     対数変換やパーセンタイル変換を用いて歪度を緩和し、極端値の影響を低減させます。セクター横断
     比較をする特徴ではセクター内Zスコアで正規化し、市場全体のトレンドよりも同業他社比の異常を
     捉えられるよう工夫します。
   • 特徴量エンジニアリングの視点：価格・出来高から得られるテクニカル指標の高度化、ファンダメン
     タルやイベント情報からの収益機会の抽出、投資家フローやポジションから読み取れるセンチメント




                                1
   や需給、および市場全体や外部要因からのレジーム・連動性を、新規特徴として取り入れます。具体
   的には以下にカテゴリ別の提案を示します。

以上を踏まえ、各カテゴリごとに具体的な新規特徴量を提案します。


1. 高度な価格・ボラティリティ系特徴量
価格変動やボラティリティに関する既存特徴量をさらに拡張し、リターン予測力を高める特徴量を設計しま
す。


  • 高精度なボラティリティ推定：従来の終値ベースの実現ボラティリティに代わり、Yang-Zhangボラ
    ティリティなど高度なレンジベース推定量を導入します。Yang-Zhang法はオープン時のギャップと日
    中変動の両方を組み込みバイアスを低減したボラティリティ推定であり、シンプルな終値法より約14
    倍効率的（分散推定誤差が小さい）とされています 4 。例えば60日窓のYang-Zhang年率ボラを特
   徴量とすれば、大きな窓でも急激な変動を捉えやすくなります。同様にRogers-SatchellやGarman-
   Klassといった他のレンジ系ボラティリティも算出し、既存のParkinsonボラ（高値-安値のみ利用）を
   補完します。これらは終値間のギャップやヒゲ（高安）情報を活用することで、より正確なリスク把
   握に繋がります。


  • ボラティリティ・オブ・ボラティリティ（Volatility-of-Volatility, VoV）：ボラティリティ自体の変
    動性に着目した特徴量です。具体的には短期ボラ比率やボラの標準偏差を導入します。例えば「5日ボ
    ラ / 60日ボラ」の比率や、直近N日間のローリングボラ変化の標準偏差を計算し、現在のボラ水準が
    平常時からどれほど異常に変動しているかを測ります。実際、市場ボラの不確実性（vol of vol）もリ
    スクプレミアム要因となり得ることが知られており 5 6 、急激なボラ変動局面では将来リターンに
   影響を与える可能性があります。VoVが高い＝不透明感が高い局面ではリスクテイク志向が低下し株
   価が押される、といった第2のリスク因子をモデルに織り込めます。具体的な実装としては、直近20
   日間程度の毎日の実現ボラ（例えば5日ATRなど）の値を取り、その標準偏差を算出して特徴量化しま
   す。


  • リバーサル×モメンタム相互作用：短期リバーサル効果（ごく短期の過剰反動による逆戻し）と中長
    期モメンタム効果（トレンドの慣性）を組み合わせ、非線形な相互作用特徴として捉えます。例えば1
    日リターンと20日リターンの積や5日リターンと60日リターンの積などを特徴量とし、「直近急落し
    たが中期では上昇トレンド」のようなケースを捉えます。これは、上昇トレンド中の一時的押し目
    （あるいは下降トレンド中の一時的戻し）を検知するものです。このような状況では押し目買い・戻
    り売りが有効なことが多く、短期的な反発が期待できます。モメンタムとリバーサルの符号が逆転す
    る銘柄（例：20日騰落率はプラスだが1日リターンは大きくマイナス）は翌日以降上昇しやすい、な
    どの経験則に基づきます。この相互作用特徴により、個別にリターン特徴量を見るよりも条件付きの
    効果をモデルに捉えさせます。


  • オーバーナイト vs. 日中リターン：株価変動を取引時間外の動き（前日終値→当日始値）と日中の動
    き（当日始値→当日終値）に分解して特徴量化します。J-Quants APIでは前場・後場のデータも提供
    されていますが、ここでは簡便に前日終値と当日始値の比からオーバーナイトのリターン、当日始値
    と終値から日中リターンを算出します。これは、例えばオーバーナイトで大幅ギャップアップした銘
    柄は日中利益確定売りで伸び悩みやすい、といったパターンを捉えるのに有用です。また夜間に情報
    が出て株価に織り込まれる（海外市場の影響など）部分と、日本市場取引中の需給による動きを分離
    できます。具体的特徴量としては「直近5日分の平均オーバーナイトリターン」や「直近5日分の平均
    日中リターン」、あるいは累積オーバーナイト vs 累積日中の差分などを用います。過去研究では、
    オーバーナイトと日中のリターンパターンに持続性があることや、日中より夜間の情報反映が早いこ
    とが指摘されており、これを利用する形です。




                               2
   • 価格レンジ比率：価格位置・ギャップ系特徴の拡張として、高安レンジ内での終値位置やギャップ率
     の直近傾向を特徴量化します。既存では単日の「close_to_high/low」などがありますが、連続的な
     レンジ動向を捉えるために例えば「直近5日間で終値が日中レンジ上半分で終えた日の割合」や「過
     去1ヶ月でギャップアップした平均幅（始値と前日終値差の平均）」などを計算します。これは、上昇
     局面ではクローズが高値寄りになりやすい一方、トレンド転換局面では日中陰線が増える、といった
     現象を数量化する狙いです。またATR（平均的なレンジ幅）に対する当日値幅の比や、前日比ギャッ
     プをATRで標準化した値なども、ボラ環境に対する当日の動きの異常度を示す特徴として考えられま
     す。


以上の高度な価格・ボラ系特徴量により、より精緻なリスク評価や微妙な価格パターンをモデルが捉えられ
るようになります。例えばYang-Zhangボラで正確なリスク感応度を上げ、リバーサル×モメンタム特徴でト
レンド内逆張りの局面を検知し、オーバーナイト/日中の分解で情報源別の動きを捉えることで、短期予測の
精度向上を狙います。


2. 流動性・需給・投機性に関する特徴量
出来高や取引状況にまつわる流動性・需給の指標を強化し、株価変動の裏にある資金フローや投資家行動を
捉えます。


   • アミフードの非流動性指標（Amihud Illiquidity）：出来高と価格変動から計算される伝統的な流動
     性指標で、「1ドルの取引でどれだけ価格が動くか」を表します 7 。具体的には日次の絶対リターン
   を取引代金で割った値を平均したものがAmihud指標です                7   。J-Quants APIでは株価と出来高（およ
   び売買代金）が取得できるため、例えば直近20営業日のAmihud指標平均を計算して特徴量に加えま
   す。値が大きいほどその銘柄は少ない売買で価格が動きやすい（流動性が低い）ことを意味し、投資
   家の需給インパクトが大きいことを示唆します 8 。一般に流動性が低い銘柄は価格のオーバー
   シュートやリバーサルが起きやすく、情報効率も低いためアルファ機会が大きい可能性があります。
   モデルにこの非流動性特徴を入れることで、小型株など流動性不足銘柄への特異な値動きを捉える助
   けとします。


   • 出来高スパイク指標：異常な出来高増加を検知する特徴量です。具体的には当日出来高を過去X日間
     の平均出来高で割った比率や、そのZスコア（何標準偏差上か）を算出します。一定閾値以上のときに
     フラグを立てることも考えられます。出来高の急増は新規材料に対する市場の関心集中や需給の偏り
     を意味し、直後のリターンに影響を及ぼすケースがあります。例えば出来高激増＋上昇の場合はブレ
     イクアウト（買いエネルギー顕在化）の可能性が高く、短期上昇の継続につながるかもしれません。
     一方、出来高激増にもかかわらず株価下落の場合は投げ売りのピークで反発しやすいといったシナリ
     オも考えられます。モデルには出来高スパイクの大きさ（例：直近5日平均比）と方向（株価上昇or下
   落のフラグ）を組み合わせて供給することで、需給イベントを定量的に扱います。


   • 信用取引残高（買い残・売り残）：JPXのAPIから日々の信用取引残高（ /markets/
     daily_margin_interest ）や週次の信用取引残高（ /markets/weekly_margin_interest ）が取得可能
     です。信用買い残は投資家の強気ポジション蓄積、信用売り残は弱気ポジション（空売り）蓄積を表
     します。研究によれば、日本では信用取引は主に個人投資家によるものであり、信用買いの動向が将
     来の短期リターンを予測することが示唆されています 9 。例えば信用買い残の急増は個人の過熱買
   いを示し、その後の株価下落に繋がりやすい可能性があります。一方、信用売り残（空売り）の積み
   上がりは将来の買い戻し需要となり、上昇圧力となるケースも考えられます。具体的特徴量案として
   は「時価総額比の信用買い残高」「貸借倍率（信用買い残/信用売り残）」「信用取引残高の直近1ヶ
   月増加率」などが考えられます。これらを1日以上遅れで反映（公表タイミングに注意）することで、
   個人投資家のセンチメントやポジションの偏りをモデルに加味します。




                                     3
  • 空売り動向指標：J-Quants APIには空売り比率（業種別空売り比率 /markets/short_selling ）や空
    売り残高（ /markets/short_selling_positions ）のデータも存在します。ここから個別銘柄または
    市場全体の空売り比率を特徴量にできます。たとえば「その銘柄の浮動株に対する空売り残高比率」
    や「空売り比率の直近1ヶ月平均」を計算します。空売りが高水準な銘柄は、機関投資家などがネガ
    ティブ視している（割高と見ている）ことを示唆し、実際将来リターンが低下する傾向があると報告
    されています 10 。つまり高い空売り残高は弱気シグナルと解釈できます 10 。一方で空売りが極端
   に積み上がった状態では、ポジティブな材料でショートカバーによる急騰（空売り筋の買い戻し）も
   起こり得るため、空売り指標は他のモメンタム系特徴と組み合わせて解釈する必要があります。モデ
   ルには空売り比率そのものに加え、「空売り比率が過去xヶ月で最大かどうか」というフラグや、空売
   りの増減ペースも入れておくと効果的です。


  • 投機的需給イベント指標：需給に関連する特殊なイベントも特徴量化します。例えば毎年末の需給
    （投信のドレッシング買い・解約売りなど）を捉えるために「12月最終週フラグ」を立てたり、IPO
    直後のリターン癖を捉えるために「上場直後〇日以内フラグ」を設ける等です。J-Quants APIから直
    接取得できる情報ではありませんが、上場日や市場変更日はマスターデータから得られますので、そ
    れを利用します。また日銀ETF買い入れの影響を考慮し、過去の日銀ETF買いオペ実施日データがあれ
    ば「日銀買い入れ実施日の市場上昇率」を特徴量として持たせ、政策的需給も織り込むことが可能で
    す（※本件はJ-Quants標準データ外ですが、公開情報で対応可能）。


以上の流動性・需給系特徴により、流動性リスクや投機筋の動きをモデルが理解できるようになります。例
えばAmihud指標で価格インパクトの大きい銘柄を割り引いて評価したり、空売り比率上昇に注目してネガ
ティブ材料の先行シグナルを捉えたりできます。また信用買い残の増減で個人の過熱感を把握し、逆張りの
手掛かりとすることも可能です 9 。需給要因は価格動向の裏付けとなる重要情報であり、これらを特徴量に
加えることでモデルの説得力と予測精度が向上すると期待されます。


3. ファンダメンタル・イベント系特徴量
企業の業績や各種イベントに関するデータから、業績サプライズやイベント効果を捉える特徴量を提案しま
す。J-Quants APIは財務情報や決算予定日、配当情報などを提供しており、これらを活用します。


  • 決算サプライズと事後ドリフト：決算発表における業績のサプライズ（予想比）を特徴量に組み込み
    ます。具体的には、四半期EPSや営業利益について市場コンセンサスとの差異（％）を計算し、発表
    日翌日以降一定期間その値を保持する特徴量とします（発表前はゼロ、または直前の値を保持）。さ
    らに決算後の株価モメンタムも捉えます。ポジティブサプライズを出した銘柄は発表後も上昇が続き
    やすく、ネガティブサプライズ銘柄は下落が続くという「ポスト決算アナウンスメントドリフト
    （PEAD）」現象が知られています 11 。そこで、決算翌5日間の累積リターンなどを計算し、それを
   「決算後ドリフト」特徴量として保持します（こちらも次の決算発表まで値を固定）。これによりモ
   デルは直近決算の良し悪しとその余波を認識できます 11 。サプライズデータはJ-Quants APIにアナ
   リスト予想が無い場合、自前で集計が必要ですが、前年同期比成長率と事前の株価変動から代理する
   ことも検討できます。


  • ガイダンス偏差・進捗率：日本企業は通期業績予想（会社予想）を発表します。その進捗率（累計実
    績/予想）や、予想の上方・下方修正が重要情報となります。J-Quantsの財務APIで四半期業績と会社
    予想が得られる場合、第○四半期終了時点の進捗率を算出し、同業他社や過去平均と比較した偏差を
    特徴量にします。例えば「2Q終了時点で通期計画の80%達成」はかなり保守予想かつ上振れ余地大と
    捉えられます。同様に会社予想の修正（増額・減額）イベントを特徴量化し、その発生日から一定期
    間フラグを立てます。増額修正は強い買いシグナル、減額は売りシグナルとなり得るためです。進捗
    率や修正情報はリーク防止のため発表翌日からモデルに反映させ、過去に遡っては使わないように注
    意します。




                                4
   • セクター横断のファンダ異常検知：企業業績や財務指標についてセクター内での相対的な異常度を測
     る特徴量です。例えば利益成長率のセクター内Zスコアや予想PERのセクター内順位などを計算しま
     す。これは「同業他社と比べて異様に高成長/低成長」「割安/割高」といった情報を提供します。セ
     クター平均や中央値との差を取ることで、市場全体のトレンドに左右されない評価が可能です。具体
     的には、「四半期営業利益YoY成長率」を各業種33業種毎にZスコア正規化し、+2以上なら異例の高成
     長フラグ、-2以下なら低成長フラグを立てる、といった形です。またセクター平均からの売上高・利
     益率逸脱度やセクター内ランキングそのもの（順位を[0,1]で表す）も考えられます。これにより、例
     えば同業が軒並み減益の中で一社だけ増益といったケースを捉え、マーケットシェア拡大などポジ
     ティブ要因のシグナルを漏らさないようにします。一方、これは過剰反応の修正局面も捉えます。つ
     まり高成長銘柄は既に買われ過ぎて将来調整する可能性や、低成長銘柄は悪材料出尽くしでリバウン
     ドする可能性もあり、モデルはこれら極端な状況を認識して適切な方向に重み付けできるようになり
     ます。


   • 決算発表前後ウィンドウのリターン特徴：決算前後の価格動きを直接特徴量化します。例えば「決算
     発表日の前後5営業日の累積リターン」や「発表前日の異常値動きフラグ」を作ります。これは未公開
     情報の漏洩や期待/不安による事前株価変動、および結果に対する即時反応を捉えるためです。もし決
     算直前に株価が大きく上がっていたら良い決算を織り込んでいた可能性が高く、発表後は材料出尽く
     しで下がるかもしれません。逆に事前株価下落＋実際は無難決算ならリバウンドする、といったシナ
     リオです。モデルはこれら直近の文脈を特徴で与えられることで、決算直後の予測精度向上に寄与す
     るでしょう。


   • 重要開示フラグ：適時開示情報などで特に株価にインパクトを与える重要イベントの有無を特徴量と
     します。J-Quants財務情報には「重要開示事項フラグ」が含まれている可能性があります（仕様書に
    言及のあった「重要開示フラグ」）。これは例えば特別損失計上や大型投資発表など株価動きを伴い
    やすい開示に会社側がチェックを付けるものです。これを活用し、当該開示があった日から一定期
    間、binaryなイベント特徴量としてモデルに供給します。重要開示の内容如何によって株価は大きく
    変動しますが、少なくとも平時とは異なる変動リスクがあることをモデルに認識させる意図です。内
    容まで判断させるのは難しいですが、重要開示フラグと直後のリターンを併用することで（プラス材
    料なら上昇、マイナスなら下落という反応を示すはず）、モデルがイベントとその結果を学習できる
    可能性があります。


   • 経過日数特徴（イベント距離）：決算発表からの経過日数、配当落ちからの経過日数、上場からの日
     数など、各種イベントからどれくらい時間が経ったかを特徴量にします。例えば決算直後は情報効果
     が強いが日数経過とともに薄れる、配当落ちは直後に価格調整されるが1ヶ月もすると元に戻る傾
     向、など時間減衰効果をモデルに取り入れます。具体的には「前回決算から○営業日経過」を数値で
     与えたり、「次回決算まであと○日」（予定日ベース）を与えても良いでしょう。後者はイベントリ
     スクの近さを意味し、決算が近い銘柄は発表跨ぎ回避で値動きが鈍るなどの傾向を加味できます。


以上のファンダ・イベント系特徴量によって、モデルは企業の根源的価値変化やイベントドリブンな価格変
動を捉えられるようになります。特に決算サプライズとその後のドリフト特徴により、過小評価された情報に
基づく持続的な株価トレンドを捉えることが期待されます 11 。またガイダンス修正や進捗率からは将来の業
績方向感を推測できます。これらは価格系列のテクニカル指標だけでは得られない独立した情報源であり、
多角的なモデル判断につながります。


4. 投資家フロー・センチメント特徴量
株式市場には様々なタイプの投資家が参加しており、その売買フローは需給やセンチメントを反映します。J-
Quants APIでは投資部門別売買動向（ /markets/trades_spec ）として、週次ベースで投資主体（海外投資




                               5
家、個人、機関等）の売買代金データが取得可能です。これらを日次に展開・加工し、センチメント特徴量
を構築します。


  • 海外投資家のフロー：海外投資家（外国人）は日本株市場の需給を大きく左右する主体であり、その
    売買動向は重要な手掛かりとなります。具体的特徴量案として、「外国人投資家の買越額（ネッ
    ト）」を市場全体に対する割合で算出します（例：その週の外国人買越額 / 東証全体売買代金）。さ
    らに直近数週間の平均買越額との偏差や累積フローも考慮します。例えば「直近4週合計の外国人買越
    額」をGDP比や時価総額比でスケールした値は、外国人が中長期で資金流入させているか流出させて
    いるかを示します。研究によれば外国人の買越しは株価上昇と相関が高く、大きな買い越しが続くと
    きはマーケットに強気トレンドが生じやすいです 12 （実際、日本株の変動要因として円安と並んで
   外国人フローが指摘されます）。モデルには「外国人フローのZスコア（過去1年基準）」や「外国人
   フローの4週移動平均」などを日次で持たせ（週データは該当週の各営業日に同じ値を割当てる等で
   展開）、継続的な資金流入出を把握させます。


  • 個人投資家のフロー：個人（国内）の売買動向も特徴量にします。一般的に個人投資家は逆張り志向
    が強い傾向があり、相場下落局面で買い越し・上昇局面で売り越しになりやすいと言われます。この
    ため個人の大量買い越しは相場底打ち（買い場）を、個人の大量売り越しは相場天井（売り場）を示
    唆する場合があります。特徴量としては「個人投資家ネット買越額の週次推移」「個人フローの移動
    平均乖離」などを用意します。例えば個人フローの直近1ヶ月Zスコアが+2を超える（大幅買い越し）
    場合に逆張りシグナルと捉える、等です。もっとも、近年は個人も多様化しており一概には言えませ
    んが、信用評価損益率などと組み合わせると個人の追証売り局面を察知できたりします（これは高度
    なので本設計では割愛）。


  • 投資主体間のシフト：外国人・個人・信託銀行・事業法人など主要主体の売買シェア変化を特徴量化
    します。例えば「その週に誰が市場を主導したか」を示すため、各主体の売買シェア（売買代金に占
    める割合）を計算し、前週比で増減した割合を出します。これにより、主体の入れ替わり（例：外国
    人が一気に買い越し転換した週、など）を検知します。特に外国人と信託銀行（年金など）は継続フ
    ローになりやすく、主体転換はトレンド転換のシグナルにもなり得ます。また主体間のフロー相関を
    見るために、「外国人買い越しかつ個人買い越し」のような組み合わせフラグも考えられます。通
    常、個人と外国人は逆のケースが多く、両方買い越しとなるのは稀ですが起きた場合は市場に相当強
    いポジティブ材料があったと推測されます。


  • 資金フローのモメンタムと衝撃：フローにもモメンタムが存在します。例えば海外勢の買い越しが何
    週連続続いているかや、直近フローが長期平均からどれだけ跳ねているか（衝撃の大きさ）を特徴量
    にします。具体例として「外国人買越し連続週数」「先週の買越額が過去1年平均の何倍か」といった
    指標です。前者はセンチメントの持続性、後者はショックの度合いを示します。例えば10週連続で外
    国人が買い越している場合、強い上昇トレンドが形成されている可能性が高いです。一方、突発的に
    大きな買い（売り）が入った週はその直後に短期的なオーバーシュートの修正が起こる可能性があり
    ます。モデルはこれらフローの継続性・極端性を学習することで、需給起因の過熱感を捉えられま
    す。


  • 日次へのブリッジ：週次データを日次に展開する際は、シンプルに各営業日に同じ値を持たせるほ
    か、週内で直線補間したり、前週金曜から当週金曜にステップで変化させる方法があります。より精
    緻には、「週間ベースで判明するフローを各日にならす」ために日次騰落率でウェイト配分する方法
    も考えられます。例えば週初大きく上昇した場合はその日に多くの買いフローがあったと推定する、
    等です。ただし過剰に凝った推定はリークの可能性もあるため、本プロジェクトでは単純な保持or補
    間で十分でしょう。重要なのはフロー情報を遅れなく織り込むことであり、発表の翌営業日からその
    週データを利用するようタイミング制御します。


以上のフロー・センチメント特徴により、モデルは需給トレンドや市場参加者のムードを感じ取ることがで
きます。特に外国人フローは日本株の中長期トレンドと密接に関わるため、そのモメンタムを加味すること



                        6
でトレンドフォロー/逆張り判断の精度が上がるでしょう 12 。また個人や他主体の情報も、マーケットの歪
みを補正するのに役立ちます。センチメント要素を加えることで、価格・ファンダメンタルだけでは説明でき
ない需給ギャップによる短期変動を捉える狙いです。


5. 指数・先物市場データと市場レジーム特徴量
株式個別銘柄の動きは、市場全体の動向や先物・オプションなどデリバティブ市場の動きにも影響されま
す。そこで市場指数や先物データを活用した特徴量、およびそれらから判定される市場レジームを提案しま
す。


     • 指数リターンとギャップ：TOPIXや日経平均など市場ベンチマーク指数のリターンを個別銘柄特徴量
       として組み込みます。既存特徴量にも「市場リターン（1/5/10/20日）」がありますが、さらに指数と
       先物の乖離（ベーシス）に注目します。先物ベーシスとは、株価指数先物価格と現物指数の差で、理
       論上は金利や配当要因で決まるものの、需給によって変動します。ベーシスがプラス方向に拡大（先
       物高、現物安）している場合、先高観が強いか裁定買い期待がある状態と考えられます。逆にベーシ
       ス縮小やマイナスは弱気シグナルです。具体的特徴量として、「直近のTOPIX先物ベーシス（先物価
       格-現物指数水準を現物値で割った％）」「ベーシスの1ヶ月平均との差分」を算出します。これによ
       り裁定取引の圧力や市場センチメントを測れます。


     • 先物出来高・建玉：J-Quantsの先物OHLC API（ /derivatives/futures ）からは先物取引高や建玉残
       高（取組高）も取得できる可能性があります。先物の出来高は投機資金の参入度合いを示し、急増時
       は相場転換点となることもあります。建玉残高（オープンインタレスト）はポジションの積み上がり
       具合で、これが増加傾向で価格上昇なら「新規資金流入による上昇」、価格上昇なのに建玉減少なら
       「ショートカバー主体の上昇（持続力低い）」と判断できます。特徴量として、「先物建玉の直近20
       日増減率」や「価格変化に対する建玉変化の相関」を算出します。具体的には先物価格の10日騰落と
       建玉10日増減が同方向か逆方向かでフラグを作ることも有効でしょう。逆方向（例：価格上昇だが建
       玉減少）は買戻し局面を意味し、その後伸び悩む可能性があります。一方、共に増加は新規マネー流
       入でトレンド継続に好ましいシグナルです。


     • オプション・ボラティリティ指標：JPX APIには日経225オプションのデータもあります。ここからイ
       ンプライド・ボラティリティ指数（日本版VIXに相当）を取得できれば理想的です。仮に無い場合で
       も、IV水準を示す指標を代替的に使えます（例えばATMオプション価格と残存日数から概算IVを推定
       するなど）。ボラ指数は市場参加者の予想する先行き不安度を表し、急上昇時は株価急落局面と重な
       ります。特徴量としては「日経VI（恐怖指数）」や「VIの20日平均乖離」を用います。またIVとHV
       （ヒストリカルボラ）の差（ボラティリティリスクプレミアム）も特徴となり得ます。これはプラス
       （IV>HV）であれば将来不安が強くリスクオフ、マイナスなら楽観的とも読めます。オプションIVデー
       タはもし利用できれば強力ですが、無い場合は本特徴量はスキップします。


     • 市場レジーム判定：上述の各種情報を組み合わせて、市場の状態をいくつかに分類し、その状態を示
       す特徴量（ダミー変数）を作ります。例えば以下のような簡易レジーム分類が考えられます。


     • ブル相場：市場指数が中長期MAを上回り、低ボラティリティかつ緩やかな上昇トレンド（例：TOPIX
       が200日線比+5%以上で、20日HV20%未満）。
     • ベア相場：市場指数が中長期MAを下回り、高ボラティリティで下降トレンド（例：200日線比-5%以
       下、20日HV30%以上）。
     • レンジ/シュリンク：低ボラ圏で方向感なく推移（20日HVが過去1年20％タイル以下かつ指数1ヶ月リ
       ターン±1％内）。
     • 高ボラ急変動：ボラ急騰局面（VI急上昇 or HVが上位5％水準）。スクイーズからのブレイクアウト等
       も含む。




                                   7
これらの状態を日次で判定し、one-hotエンコードした特徴量を与えます（bull, bear, volatile, calmなどの
フラグ）。既存の特徴量でも単純なレジーム（bull/high_vol等）は入っていますが、さらに先物やVI等を組
み合わせて強い材料が一致する場合のみフラグにするなど精度を上げます。レジーム特徴量を持たせること
で、モデルは現在の市場環境を認識し、例えば弱気相場ではバリュー指標の効きが悪くなる等の特徴量効果
の文脈依存性を学習できます。


   • 他国市場・クロスアセット指標：グローバルな市場連動も考慮します。日本株は米国株や米金利、為
     替などに影響を受けるため、外部指標をいくつか導入します。詳細は後述の外部データ特徴量で述べ
     ますが、レジーム判定時に米国株との相関等も考慮可能です。たとえば米国市場が弱気入り（S&P500
     が調整局面）かどうかで日本株への波及度合いを変える、といった発想です。

これら指数・先物・レジーム系特徴量により、モデルは個別銘柄を取り巻くマーケット全体の状況を把握で
きます。特に先物ベーシスや建玉からは、現物市場に現れにくい機関投資家のセンチメントを読み取れます。
また市場レジームフラグは、モデルが異なる市場環境下で適切な判断を下すのに役立ちます。例として、高ボ
ラ・弱気相場ではモメンタムよりも品質やバリュー指標を重視し、低ボラ相場では逆張り指標の信頼度を下
げる、といった具合です。これらを特徴量として与えることで暗黙的に条件分岐を表現し、マルチホライズン
予測の安定性を高めます。


6. コーポレートアクション・特殊イベント特徴量
個別銘柄固有のイベント（株式数の変化や株主構成変化など）は株価に影響を及ぼします。これらコーポ
レートアクションやその他イベントを特徴量化します。


   • 配当イベント：配当落ちや権利付き最終日の影響を考慮します。権利落ち日は理論上配当分株価が下
     がりますが、その前後で配当再投資買いや需給反転が起こり得ます。特徴量として「配当落ち直後○
     日間」のダミーや、「配当利回り」（高配当銘柄は権利取りで権利日前に上がりやすい）を持たせま
     す。J-Quantsの配当金情報API（ /fins/dividend ）から各銘柄の配当予想や権利日が取得できるの
     で、それを利用し権利付き日までの日数や直後の日数を特徴にします。また予想配当利回り（予想1株
     配当/株価）も計算して特徴量に加えます。高利回り銘柄ほど配当狙いの買いが入り下支えされやすい
     反面、配当落ちで急落しやすい傾向もあるため、モデルがその性質を学べるようにします。


   • 株式分割・併合：株式分割は流動性向上や名目株価引き下げにより個人買いが増える傾向があり、発
     表後に株価が上がりやすいイベントです。J-Quantsのコーポレートアクション情報で株式分割/併合
     を取得し、発表日から効力発生日前後にフラグを立てます。具体的には「株式分割発表後1ヶ月間」の
     ダミーや、「分割比率」を特徴量化します（大きな分割ほどインパクト大）。また併合（株数減少）
     は逆で実質株価上昇となるため需給はネガティブです。これらイベントフラグにより、モデルは分割
     による株価上昇バイアスや併合による下落バイアスを織り込めます。


   • インデックス採用・除外：TOPIX等の指数への新規採用や除外も株価に影響します。採用が決まると
     指数連動ファンドからの買い需要で上昇しやすく、除外は売り需要で下落しやすいです。ただし発表
     から実施まで間があり、その間に織り込まれるケースが多いです。J-Quants Proには指数構成変更の
     データセットもあるようですが、一般的にはプレスリリース等から情報取得が必要です。本プロジェ
     クトでは、例えばTOPIX浮動株比率見直しや日経平均入替など大きなもののみ手動でデータを用意
     し、該当銘柄にフラグを付与する方法も考えられます。現時点ではそこまで踏み込まずとも、出来高
     急増や株価急騰/急落で間接的にモデルが捕捉できる可能性もありますが、可能なら特徴量として明示
     すると良いでしょう。


   • IRニュース/適時開示テキスト解析：テキスト由来の特徴量として、大きな株価材料となりうるニュー
     スに関するフラグを検討します。適時開示情報（TDnet）の見出しや内容をテキスト分析できれば理
     想ですが、本プロジェクトでは簡便にキーワードマッチで特徴量化することを提案します。例えば開
     示情報のタイトルに「上方修正」「増配」「大型受注」「M&A」等ポジティブワードが含まれれば



                                8
   +1、下方修正や減配等ネガティブワードなら-1、といったサプライズイベントスコアを発表日に付与
   します。これを一定期間（3日～1週間程度）減衰させながら特徴量として残すことで、ニュースの影
   響期間をカバーします。J-Quants API自体が適時開示のテキストまでは提供しないかもしれません
   が、重要開示フラグや株価急変動で代理させる手もあります。テキスト解析は難度が上がるため必須
   ではありませんが、もし実装できれば定性的材料を組み込めるメリットがあります。


以上、コーポレートアクションや特殊イベントに関する特徴量で、価格変動要因の取りこぼしを防ぎます。
モデルはこれら特徴により、例えば「近日大型分割予定だからこの株は需要増で強いだろう」とか「指数除
外決定で需給悪化」といった人間の判断に近い要素も考慮できます。配当利回りは特に金利環境との相対評
価にも繋がるため、後述の金利動向と合わせて、バリュー的側面も補強できるでしょう。


7. 外部マクロ・クロスアセット特徴量
最後に、株式市場の外部環境を表す特徴量を提案します。金利・為替・コモディティ価格・海外株式指数な
ど、J-Quants API外のデータも活用しますが、これらは日本株の動きと密接に関連するため組み込む価値が
あります 12 。


   • 金利関連：日本の長期金利（10年国債利回り）や米国金利（米10年債利回り、FF金利先物など）を特
     徴量に加えます。一般に金利上昇は株式にはマイナス（将来キャッシュフローの現在価値低下、企業
     調達コスト増）とされます。ただし 12 によれば、日本では過去低金利下で国内金利の株価への直接
   影響は小さいとの指摘もあります。その代わり為替や米株の方が影響大でした 13 。とはいえ、直近
   では日本もYCC修正などで金利変動しつつあるため無視できません。特徴量として、「日本10年債利
   回りの変化率（1ヶ月）」「米2年-10年スプレッド」などを入れます。金利と株価の関係は時期により
   ますが、金利上昇＝金融株に追い風/ハイテクに向かい風などセクター感応度もあります。高度にはセ
   クター×金利の相互作用特徴を作る手もありますが、まずは全体への影響を見るため単体特徴で十分
   でしょう。


   • 為替レート：ドル円為替レートは日本株特に輸出関連に大きな影響があります。一般に円安（ドル
     高）は日本株にプラスです 14 。円安は輸出企業の競争力を高め、外貨建収益を押し上げるため、株
   価も上がりやすくなります 14 。特徴量として、「USD/JPYの前日比％変化」や「直近5日間の円安傾
   向（5日で何％円安）」等を入れます。また実効為替レートや他通貨も見るなら、「人民元やユーロ対
   円レート」も考えられますが、まずUSD/JPYが代表でしょう。モデルは為替変動特徴を使って、例え
   ば急激な円高局面では輸出株の下落を予測に織り込む、といった対応が期待できます。


   • 商品価格：原油価格や商品指数（CRB指数）などコモディティ価格も特徴量に加えます。原油は資
     源・素材株の収益に直結し、また全般にインフレ指標でもあります。例えばWTI原油先物価格の1ヶ月
   騰落率や国内ガソリン価格の変化を入れます。資源高は商社や石油株にはプラス、電力や素材コスト
   にはマイナスという具合に銘柄によって作用が異なりますが、市場全体では適度な上昇は景気回復シ
   グナル、急騰はコスト高懸念となります。このためモデルには一次的には全銘柄共通特徴として入れ
   つつ、銘柄別の影響はモデル内部で学習させます。また金や銅など指標的商品もあれば入れてもよい
   ですが、複雑になるので主要な原油だけで十分かもしれません。


   • 海外株式指数：米国株（S&P500やNASDAQ）の動向は日本株にとって重要な先行指標です 12 。米
   市場の大幅上昇・下落は翌日の日本市場にも高確率で波及します。特徴量として、「前日S&P500先物
   の夜間変動（日本時間早朝までの変化）」や「NASDAQ指数の5日リターン」などを入れます。特に米
   国ハイテク市場との連動を見るならNASDAQ、全般的リスクオン/オフを見るならS&P500かNYダウで
   す。J-Quantsには海外指数は無いので外部取得になりますが、精度向上のため是非組み込みたい情報
   です。また中国株（上海指数）など地域の主要市場も影響大きいですが、まず米国中心で良いでしょ
   う。モデルはこれらを使い、例えば米株急落していれば日本株個別銘柄の予測も総じて弱気にシフト
   させる、といったグローバルリスク要因を反映できます。




                            9
   • ETF資金流入出：もしデータ入手可能なら、日本株ETFへの資金流入額なども考えられます。海外投
     資家動向と被る部分もありますが、特に特定セクターETFのフローなど細かく見ると、どのテーマに
     資金が向かっているか分かります。本プロジェクト範囲では難しいため、ETFフローはマーケット全
     体の外国人フローで代替する形とします。


これら外部要因特徴によって、モデルは国内市場の外側から働く力を認識できます。例えば、円安進行＝輸出
株の将来EPS押上げ要因としてモデルが学習し、円安局面ではそれら銘柄のtarget上昇を予測する、というよ
うな挙動が期待できます 14 。また米国株の下落を捉えて保有株全般のtargetを引き下げれば、実際の翌日下
落を当てやすくなります 12 。特に昨今はグローバル市場連動性が高いため、海外指数や為替を使った特徴
量は予測精度向上に不可欠と考えられます。


おわりに：新規特徴量導入による効果と実装上の注意
以上、多角的な新規特徴量を提案しました。これらを既存のOHLCVテクニカル指標群やファクター群に追加
することで、モデルの性能向上が期待できます。特にボラティリティ精度向上や需給・センチメントの取り込
み、イベント反応の捉えなど、現在不足している側面を補完する役割を果たします。


実装に際しては以下の点に注意します。


   • リーク防止徹底：週次・月次データは公表日を意識して特徴量に適用し、将来の値を過去日に誤って
     入れないようにします。例えば「外国人フロー当週値」は週末にしか分からないので、その週の月～
     木には前週値を使い、金曜夜または翌週月曜から当週値を使う等の工夫をします。決算情報も発表翌
     日から有効にするタイミング管理が重要です。
   • 正規化と欠損：新規特徴量も、学習データ内で計算した分布（平均・標準偏差）で標準化し、外れ値
     はクリッピングまたはtanh縮小など行います。クロスセクションでの標準化に加え、期間を跨ぐ特異
     値（例えばコロナショック時のVI急騰など）は適宜上限を設けます。また銘柄ごとに利用可否が異な
     る特徴（例：新興市場銘柄には決算予想がない等）は欠損値処理をします。欠損は0埋めではなく、無
     効フラグを別途立ててモデルに認識させるか、あるいは平均値で埋めつつ上記フラグで対応します。
   • 特徴量選択：提案量は多岐に渡りましたが、全てを投入すると過学習リスクもあります。相関の高い
     特徴同士は主成分的に圧縮するか、一部はモデル側の正則化（L1など）に頼る形でも良いでしょう。
     経験的に重要度が高そうなもの（例えば為替、外国人フロー、IV、水準ボラなど）から優先実装し、
     順次効果を検証していきます。LightGBMのゲインやシャープ値改善度などでフィルタリングするアプ
     ローチも有効です。

最後に、本提案の特徴量を用いることでRankICやシャープレシオといった評価指標の改善が見込めます。例
えば5日先RankICについて、従来価格系テクニカルのみでは0.02程度だったものが、ファンダ・フロー特徴の
追加で0.03台に上昇し、情報比（RankIC_IR）も向上することが期待されます。またシャープレシオも、下落
局面での予測精度向上によりドローダウンが抑制されれば改善するでしょう。これら仮説は実装後のウォー
クフォワード検証で確認します。


以上、J-Quants APIで取得可能なデータをフル活用した新規特徴量の提案を行いました。価格・テクニカル
指標の精緻化からファンダメンタル、投資家フロー、外部環境まで網羅することで、モデルのアルファ捕捉
能力が大きく高まることを期待します。各特徴量は漏洩に注意しつつ適切に正規化して組み込むことで、堅牢
かつ高性能な予測モデルの構築に寄与するでしょう。


参考文献・出典: 本提案内容の一部には以下の情報源を参照・引用しています。


   • Yang-Zhangボラティリティの有効性   4

   • Amihud流動性指標の定義   7

   • 信用取引（個人投資家）のリターン予測力         9




                                     10
       • Post-Earnings Announcement Drift現象 11
       • 空売り筋の情報優位性 10
       • RankICおよびSharpe比の指標解説              1    2

       • 円安が企業収益・株価に与える好影響                      14

       • 日米における株価決定要因（為替・米株 vs 金利）の分析 12

 4    “Yang Zhang is a historical volatility estimator that handles both opening jumps and the drift and has
a minimum estimation error... Yang-Zhang volatility... considered being 14 times more efficient than the
close-to-close estimator.”
  7  “Amihud (2002) proposes to measure illiquidity by the ratio of absolute stock return to its dollar
volume... interpreted as ‘the daily price response associated with one dollar of trading volume’   8   .”
 11   “The returns of good news firms continue to drift up and those of bad news firms drift down. It is to
date one of the most robust market “anomalies” in the stock [market].”
 9   “Margin trading ... dominated by individual investors in Japan... significant cross-sectional
relationship between margin buying and stock returns... margin buying helps predict future stock
returns, especially for small-firm stocks at short horizons 9 .”
 10   “studies by Dechow... and Takahashi (2010) suggest that short sellers are indeed skilled at selecting
companies that exhibit lower expected future returns 10 .”
 14   “The weakening yen has provided a dual benefit to Japanese companies’ earnings... enhanced the
competitiveness of exporters... and boosted earnings directly through favorable translation of foreign
revenues 14 .”
 12   “finds that interest rates have not impacted Japanese stock prices but exchange rates and U.S. stock
prices have 12 .”
 1    “Spearman rank IC... is the Pearson correlation coefficient between the ranked factor scores and
ranked forward returns, ... less sensitive to outliers and can therefore provide a more accurate measure of
a factor’s predictive power 1 .”
 2    “The Sharpe ratio... compares the return of an investment with its risk... numerator is the difference
between returns and a benchmark (risk-free rate)... denominator is the standard deviation of returns... a
measure of volatility 2 .”




                                                     11
 1   Quantitative Investing - CFA, FRM, and Actuarial Exams Study Notes
https://analystprep.com/study-notes/cfa-level-iii/quantitative-investing/

 2   Sharpe Ratio: Definition, Formula, and Examples
https://www.investopedia.com/terms/s/sharperatio.asp

 3   株価四本値(/prices/daily_quotes) | J-Quants API
https://jpx.gitbook.io/j-quants-ja/api-reference/daily_quotes

 4   Yang-Zhang Volatility | PortfoliosLab
https://portfolioslab.com/tools/yang-zhang

 5    6   The importance of volatility of volatility | Macrosynergy
https://macrosynergy.com/research/the-importance-of-volatility-of-volatility/

 7    8   ba-odegaard.no
https://ba-odegaard.no/teach/notes/liquidity_estimators/amihud_estimator/amihud_lectures.pdf

 9   Can margin traders predict future stock returns in Japan?
https://ideas.repec.org/a/eee/pacfin/v17y2009i1p41-57.html

10   Short-sale inflow and stock returns: Evidence from Japan | Request PDF
https://www.researchgate.net/publication/257211637_Short-sale_inflow_and_stock_returns_Evidence_from_Japan

11   Post-Earnings-Announcement Drift and Analyst Forecasts
https://www.anderson.ucla.edu/documents/areas/fac/accounting/drift503.pdf

12   13   Relationship between Exchange Rate and Stock Prices during Quantitative Easing Policy in Japan
https://ijb.cyut.edu.tw/var/file/10/1010/img/852/V114-3.pdf

14   Will the Yen Continue to Support Japanese Equities? - Cambridge Associates
https://www.cambridgeassociates.com/insight/will-the-yen-continue-to-support-japanese-equities/




                                                                12
